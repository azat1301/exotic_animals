<div data-controller="calculation" class="container-md mt-5">
  <div class="row">
    <div class="col-12 col-md-8">
    <div class="d-flex justify-content-center">
      <div class="card-trip" id="card-show">
        <img id="img-show" src='<%= @animal.photo.attached? ? cl_image_path(@animal.photo.key) : "https://mycountrysidevet.com/wp-content/uploads/2018/08/shutterstock_1043006710.jpg" %>' />
        <div class="card-trip-infos">
          <div>
            <h1><strong><%= @animal.name %></strong></h1>
            <h2>Species: <%= @animal.species %></h2>
            <p>Location: <strong><%= @animal.location %></strong></p>
          </div>
          <h1 class="card-trip-pricing">$<%= @animal.price %></h1>
          <%# <img src="https://kitt.lewagon.com/placeholder/users/yannklein" class="card-trip-user avatar-bordered" /> %>
          <img src='<%= @animal.user.photo.attached? ? cl_image_path(@animal.user.photo.key) : "https://kitt.lewagon.com/placeholder/users/yannklein" %>' class="card-trip-user avatar-bordered" />
        </div>
      </div>
    </div>
    </div>
    <div class="col-12 col-md-4 mt-4 mb-4">
      <h3>Ready to <strong>book?</strong></h3>
      <%= simple_form_for [ @animal, @booking ] do |f| %>
        <%= f.input :start_date, html5: true, input_html: {data: {calculation_target:"startDay", action: "change->calculation#calculate"} } %>
        <%= f.input :end_date, html5: true, input_html: {data: {calculation_target:"endDay", action: "change->calculation#calculate"} }  %>
        <%= f.submit %>
      <% end %>
      <div class="text-end">
        <p class="mt-3"><strong><%= @animal.name %></strong> (<%= @animal.species %>)</p>
        <p >$ <span data-calculation-target="price"> <%= @animal.price %> </span> x <span data-calculation-target="days">1</span> </p>
        <h3 >Total <strong>$ <span data-calculation-target="total"> <%= @animal.price %></strong></span></h3>
      </div>
    </div>
  </div>

  <div>
    <h3>Leave a Review</h3>
    <%= simple_form_for [ @animal, @review ] do |f| %>
      <%= f.input :content, input_html: { minlength: 20 } %>
      <div class="star-rating">
        <% 5.times do |i| %>
          <input type="radio" name="review[rating]" value="<%= i + 1 %>" <%= "checked" if i == 2 %> />
        <% end %>
      </div>
      <%= f.button :submit %>
    <% end %>
  </div>
  <div>
    <% @animal.reviews.each do |review| %>
      <div class="card-product mt-3 mb-4">
        <div class="card-info">
          <img src='<%= review.user.photo.attached? ? cl_image_path(review.user.photo.key) : "https://mycountrysidevet.com/wp-content/uploads/2018/08/shutterstock_1043006710.jpg" %>' />
          <div class="card-product-infos">
            <div class="d-flex">
              <% review.rating.times do %>
                <i class="fas fa-star"></i>
              <% end %>
              <% (5 - review.rating).times do %>
                <i class="far fa-star"></i>
              <% end %>
            </div>
            <p><%= review.created_at.strftime('%Y-%m-%d') %></p>
            <p><strong><%= review.content %></strong></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  <h2 class="mt-5">Where <%= @animal.name %> is located</h2>
  <div class="cards" style="width: 100%; height: 600px;"

  <h2 class="mt-5">Where the <%= @animal.name %> is located</h2>
  <div class="cards mb-5" style="width: 100%; height: 600px;"

      data-controller="mapbox"
      data-mapbox-markers-value="<%= @markers.to_json %>"
      data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>


<p>Sex: <%= @animal.sex %></p>
            <p>Age: <%= @animal.age %> years</p>
            <p><%= @animal.rarity_level %> Species</p>
            <p><%= @animal.species.pluralize %> are <strong><%= @animal.diet %>s</strong></p>
